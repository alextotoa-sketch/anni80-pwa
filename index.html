 <!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Io negli anni ‚Äô80 c‚Äôero</title>

<!-- PWA -->
<link rel="manifest" href="/anni80-pwa/manifest.json">
<meta name="theme-color" content="#00e5ff">

<!-- Favicon -->
<link rel="icon" href="/anni80-pwa/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/anni80-pwa/favicon-16.png">
<link rel="icon" type="image/png" sizes="192x192" href="/anni80-pwa/icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/anni80-pwa/icon-512.png">

<!-- iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Anni80App">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<link rel="apple-touch-icon" sizes="152x152" href="/anni80-pwa/apple-icon-152.png">
<link rel="apple-touch-icon" sizes="167x167" href="/anni80-pwa/apple-icon-167.png">
<link rel="apple-touch-icon" sizes="180x180" href="/anni80-pwa/apple-icon-180.png">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial,Helvetica,sans-serif}
  #splash{
  ...
}

.splash-inner{
  ...
}

.splash-top{
  color:#00e5ff;
  font-size:1.4rem;
  letter-spacing:2px;
  margin-bottom:18px;
}

.splash-bottom{
  color:#aaa;
  font-size:1.1rem;
  margin-top:18px;
}
body{background:#0f0f0f;color:#fff;min-height:100vh;display:flex;flex-direction:column}

/* HEADER */
header{text-align:center;padding:16px;border-bottom:none}
header h1{color:#00e5ff}
header p{color:#aaa;font-size:.9rem}

/* MAIN */
main{flex:1;padding:12px;padding-bottom:190px}

/* CATEGORIE */
.categories{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:12px}
.category{
  border:none;
  border-radius:14px;
  padding:12px;
  text-align:center;
  font-weight:bold;
  cursor:pointer;
  color:#000;
}
.categories > *:nth-child(6n+1){background:#ff0080;}
.categories > *:nth-child(6n+2){background:#00e5ff;}
.categories > *:nth-child(6n+3){background:#ffcc00;}
.categories > *:nth-child(6n+4){background:#00ff66;}
.categories > *:nth-child(6n+5){background:#ff6600;}
.categories > *:nth-child(6n+6){background:#cc00ff;}
.category.active{
  transform:scale(1.05);
}

/* CONTENUTO */
#content{border:none;border-radius:14px;padding:14px;min-height:200px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.card{border:none;border-radius:14px;padding:14px;text-align:center}
.card:hover{background:#00e5ff;color:#000}
a.card{text-decoration:none;color:inherit}
 /* CARD COLORATE 80s */
/* COLORI CARD CICLICI */
.card:nth-of-type(6n+1){background:#ff0080;}
.card:nth-of-type(6n+2){background:#00e5ff;}
.card:nth-of-type(6n+3){background:#ffcc00;}
.card:nth-of-type(6n+4){background:#00ff66;}
.card:nth-of-type(6n+5){background:#ff6600;}
.card:nth-of-type(6n+6){background:#cc00ff;}

.card{
  color:#000;
  font-weight:bold;
}

/* PLAYER */
#player{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
 background:#0f0f0f; 
  border-top:none;
  padding:18px 10px;
  text-align:center;
  z-index:500;
}
#now{color:#00e5ff;font-weight:bold;margin-bottom:6px}
audio{
  width:100%;
  max-width:850px;
  height:48px;
}

/* VU METER */
#vumeter-wrapper{display:flex;justify-content:center;margin-bottom:6px}
#vumeter{display:flex;gap:2px;align-items:flex-end;height:50px}
.vu{width:6px;height:6px;background:#222;border-radius:2px;transition:height .12s}
.vu.g{background:#00ff66}
.vu.l{background:#66ff00}
.vu.y{background:#ffee00}
.vu.o{background:#ff9900}
.vu.r{background:#ff3300}
.vu.m{background:#ff00cc}


/* CHAT */
#chat{position:fixed;inset:0;background:#111;display:none;flex-direction:column;z-index:2000}
#chatHeader{padding:14px;background:#161616;border-bottom:1px solid #222;display:flex;justify-content:space-between}
#chatHeader strong{color:#00e5ff}
#chatMessages{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:10px}

/* MESSAGGI */
.message{
  background:#1f1f1f;
  border-radius:14px;
  padding:10px 12px;
  max-width:85%;
}
.message strong{color:#00e5ff;font-size:.85rem;display:block}

/* REPLY BOX */
#replyBox{
  display:none;
  background:#222;
  padding:8px 12px;
  font-size:.85rem;
  border-left:4px solid #00e5ff;
  justify-content:space-between;
  align-items:center;
}


#replyLabel{color:#fff}
#replyNick{color:#00e5ff;font-weight:bold}

/* INPUT */
#chatForm{display:flex;padding:10px;gap:8px;background:#161616;border-top:1px solid #222}
#chatInput{
  flex:1;
  padding:12px 14px;
  border-radius:20px;
  border:none;
  background:#2a2a2a;
  color:#fff;
  font-size:16px;
}
#chatForm button{
  padding:12px 18px;
  border-radius:20px;
  border:none;
  background:#ffef00;
  color:#000;
  font-weight:bold;
}


/* CHAT TOGGLE */
#chatToggle{
  position:fixed;
  bottom:200px;
  right:14px;
  width:56px;
  height:56px;
  border-radius:50%;
  background:#00e5ff;
  border:none;
  font-size:26px;
  z-index:1100;
}

/* MOBILE */
@media(max-width:900px){
  .categories{grid-template-columns:1fr 1fr}
  #vumeter{height:40px}
}
#content hr ~ *{
  padding-left:20px;
}
  /* SPLASH INTRO ‚Äì DISSOLVENZA LENTA */
#splash{
  position:fixed;
  inset:0;
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:9999;
  opacity:0;
  animation:splashAppear 3s ease forwards,
           splashOut 8s ease forwards;
}

.splash-inner{
  text-align:center;
  opacity:0;
  animation:innerAppear 4s ease forwards;
  animation-delay:1s;
}

.splash-top{
  font-family:'Montserrat', sans-serif;
  font-size:2.4rem;
  font-weight:700;
  letter-spacing:4px;
  color:#00e5ff;
  margin-bottom:20px;
}

.splash-bottom{
  font-family:'Montserrat', sans-serif;
  font-size:1.6rem;
  font-weight:600;
  letter-spacing:2px;
  color:#e0e0e0;
  margin-top:20px;
}


#splash img{
  width:70vw;
  max-width:320px;
  margin:12px 0;
}

@keyframes splashAppear{
  from{opacity:0}
  to{opacity:1}
}

@keyframes innerAppear{
  from{opacity:0; transform:scale(1.08)}
  to{opacity:1; transform:scale(1)}
}

@keyframes splashOut{
  0%{opacity:1}
  80%{opacity:1}
  100%{opacity:0; visibility:hidden}
}
</style>
</head>

<body>
<div id="splash">
  <div class="splash-inner">
    <div class="splash-top">BENVENUTI</div>

    <img src="/anni80-pwa/logo.png" alt="Io negli anni ‚Äô80 c‚Äôero">

   <div class="splash-bottom">Negli anni 80</div>
  </div>
</div>
<header>
  <h1>Io negli anni ‚Äô80 c‚Äôero</h1>
  <!-- <p>Musica ¬∑ Radio ¬∑ Giochi ¬∑ Chat</p> -->
</header>


<main>
  <div class="categories" id="categories"></div>
  <div id="content">Seleziona una sezione.</div>
</main>

<div id="player">
  <div id="vumeter-wrapper"><div id="vumeter"></div></div>
  <div id="now">Nessuna radio in riproduzione</div>
  <audio id="audio" controls></audio>
</div>

<button id="chatToggle">üí¨</button>

<div id="chat">
  <div id="chatHeader">
    <strong>üí¨ Chat anni ‚Äô80</strong>
    <button onclick="closeChat()" style="background:none;border:none;color:#00e5ff;font-size:22px">‚úï</button>
  </div>

  <div id="chatMessages"></div>

  <div id="replyBox">
    <span id="replyLabel">Rispondi a <span id="replyNick"></span></span>
    <button onclick="cancelReply()" style="background:none;border:none;color:#00e5ff;font-size:18px">‚úï</button>
  </div>

  <form id="chatForm">
    <input id="chatInput" placeholder="Scrivi un messaggio‚Ä¶" autocomplete="off">
    <button>Invia</button>
  </form>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";
import { getAuth, signInAnonymously } 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
/* FIREBASE */
/* FIREBASE */
const app = initializeApp({
  apiKey:"AIzaSyB8h3fvyPxq_Tjp2R5RzsgEC7jv6FASeWE",
  authDomain:"anni-80-chat-a1192.firebaseapp.com",
  databaseURL:"https://anni-80-chat-a1192-default-rtdb.europe-west1.firebasedatabase.app",
  projectId:"anni-80-chat-a1192"
});

const db = getDatabase(app);
const auth = getAuth(app);

/* NICK */
let nickname = localStorage.getItem("anni80_nick");
while(!nickname){
  nickname = prompt("Inserisci il tuo nickname anni ‚Äô80:");
  if(nickname) localStorage.setItem("anni80_nick",nickname);
}

/* ELEMENTI CHAT */
const chat = document.getElementById("chat");
const chatMessages = document.getElementById("chatMessages");
const chatInput = document.getElementById("chatInput");
const chatForm = document.getElementById("chatForm");
const replyBox = document.getElementById("replyBox");
const replyNick = document.getElementById("replyNick");
let replyTo = null;

/* AUTENTICAZIONE + AVVIO CHAT */
signInAnonymously(auth)
  .then(() => {
    console.log("Autenticazione anonima attiva");
    startChat(); // üëà parte SOLO dopo auth
  })
  .catch((error) => {
    console.error("Errore autenticazione:", error);
  });

function startChat(){

  const chatRef = ref(db,"chat");

  chatForm.addEventListener("submit", e=>{
    e.preventDefault();

    if(chatInput.value.trim()){
      push(chatRef,{
        nick:nickname,
        text:chatInput.value,
        reply:replyTo || null,
        timestamp: Date.now()
      });

      chatInput.value="";
      replyTo=null;
      replyBox.style.display="none";
    }
  });

  onChildAdded(chatRef, s=>{
    const m = s.val();

    const msg = document.createElement("div");
    msg.className="message";

    if(m.reply){
      const reply=document.createElement("div");
      reply.style.fontSize=".8rem";
      reply.style.opacity=".7";
      reply.style.borderLeft="3px solid #00e5ff";
      reply.style.paddingLeft="6px";
      reply.style.marginBottom="4px";
      reply.textContent=m.reply;
      msg.appendChild(reply);
    }

    const nick=document.createElement("strong");
    nick.textContent=m.nick;
    msg.appendChild(nick);

    const text=document.createElement("span");
    text.textContent=m.text;
    msg.appendChild(text);

    msg.onclick=()=>{
      replyTo=`${m.nick}: ${m.text}`;
      replyNick.textContent=m.nick;
      replyBox.style.display="flex";
      chatInput.focus();
    };

    chatMessages.appendChild(msg);
    chatMessages.scrollTop=chatMessages.scrollHeight;
  });

}

/* UI CHAT */
window.cancelReply=()=>{
  replyTo=null;
  replyBox.style.display="none";
};

window.closeChat=()=>{
  chat.style.display="none";
};

document.getElementById("chatToggle").onclick=()=>{
  chat.style.display="flex";
};

/* RADIO + UI + VU */
const radio=[
  {n:"Radio 80",u:"https://sphera.fluidstream.eu/radio80.aac"},
  {n:"SomaFM Underground 80s",u:"https://somafm.com/u80s130.pls"},
  {n:"80s80s Italo Disco",u:"https://streams.80s80s.de/italodisco/mp3-192"},
  {n:"Italia 80",u:"https://stream.laut.fm/italia80"}
];

const categoriesEl=document.getElementById("categories");
const contentEl=document.getElementById("content");
const audio=document.getElementById("audio");
const now=document.getElementById("now");

/* VU */
const vumeter=document.getElementById("vumeter");
let bars=[],vuTimer=null;
for(let i=0;i<40;i++){
  const b=document.createElement("div");
  b.className="vu";
  vumeter.appendChild(b);
  bars.push(b);
}
function startVu(){
  stopVu();

  let levels = new Array(bars.length).fill(0);
  let peaks  = new Array(bars.length).fill(0);

  vuTimer = setInterval(()=>{

    bars.forEach((b,i)=>{

      // valore finto ma pi√π stabile
      const target = Math.random();

      // smoothing analogico
      levels[i] += (target - levels[i]) * 0.08;

      // peak morbido
      if(levels[i] > peaks[i]){
        peaks[i] = levels[i];
      }else{
        peaks[i] -= 0.01;
      }

      if(peaks[i] < 0) peaks[i] = 0;

     const h = 6 + levels[i] * 90;

      b.style.height = h + "px";
     let c="";
if(h>60) c="m";
else if(h>50) c="r";
else if(h>40) c="o";
else if(h>30) c="y";
else if(h>20) c="l";
else c="g";

b.className="vu "+c;


    });

  },60);
}

function stopVu(){clearInterval(vuTimer)}
audio.onplay=startVu;
audio.onpause=stopVu;

/* UI */
/* UI */
["Playlist","Radio","Giochi","Chat-Info"].forEach((c,i)=>{
  const d=document.createElement("div");
  d.className="category";
  d.textContent=c;
  d.onclick=()=>open(i,d);
  categoriesEl.appendChild(d);
});

function open(i,el){
  document.querySelectorAll(".category").forEach(x=>x.classList.remove("active"));
  el.classList.add("active");

  if(i===0){
    contentEl.innerHTML = `
      <h2>üé∂ Playlist</h2>
      <div class="grid">
        <div class="card" onclick="openPlaylist('foreign')">
          ‚≠ê Artisti stranieri
        </div>
        <div class="card" onclick="openPlaylist('italian')">
          üáÆüáπ Artisti italiani
        </div>
      </div>
    `;
  }

  if(i===1){
    contentEl.innerHTML = `
      <div class="grid">
        ${radio.map(r=>`
          <div class="card" onclick="play('${r.u}','${r.n}')">
            ${r.n}
          </div>
        `).join("")}
      </div>
    `;
  }

if(i===2){
  contentEl.innerHTML = `
    <h2>üïπÔ∏è Archivio Giochi anni ‚Äô80</h2>
    <div id="gamesFolders"></div>
  `;
  loadGameFolders();
}


  if(i===3){
    contentEl.innerHTML = `
      <h2>Chat-Info</h2>
      
      <h1>App PWA (Progressive Web App)</h1>

      <h2>Cos‚Äô√® una PWA</h2>
      <p>Una PWA √® un‚Äôapp web che pu√≤ essere installata come un‚Äôapp nativa, funziona offline (in parte), si aggiorna automaticamente e non richiede store obbligatori.</p>

      <hr>

      <h2>Installazione su tutti i dispositivi</h2>
      
      <h3>Android (Chrome, Edge, Firefox)</h3>
      <ol>
        <li>Tocca <strong>Installa app</strong> oppure <strong>Aggiungi a schermata Home</strong>.</li>
        <li>Conferma: l‚Äôapp apparir√† tra le app installate.</li>
      </ol>

      <h3>iOS / iPadOS (Safari)</h3>
      <ol>
        <li>Tocca <strong>Condividi</strong> (icona quadrato con freccia).</li>
        <li>Seleziona <strong>Aggiungi alla schermata Home</strong>.</li>
        <li>Conferma il nome dell‚Äôapp.</li>
      </ol>
      <p>‚ö†Ô∏è Nota: su iOS le PWA hanno alcune limitazioni (es. notifiche e processi in background dipendono dalla versione di iOS).</p>

      <h3>Desktop (Windows, macOS, Linux)</h3>
      <ul>
        <li><strong>Chrome / Edge</strong>: icona <strong>Installa</strong> nella barra degli indirizzi.</li>
        <li><strong>Safari macOS</strong>: aggiunta come app web (versioni recenti).</li>
        <li>Dopo l‚Äôinstallazione, la PWA si apre come un‚Äôapp indipendente.</li>
      </ul>

      <hr>

      <h2>Aggiornamenti dell‚Äôapp PWA</h2>
      <ul>
        <li>Gli aggiornamenti sono <strong>automatici</strong>.</li>
        <li>Alla chiusura e riapertura dell‚Äôapp, viene caricata l‚Äôultima versione disponibile.</li>
        <li>In caso di aggiornamenti importanti:
          <ul>
            <li>pu√≤ essere richiesto un <strong>refresh</strong></li>
            <li>oppure il riavvio dell‚Äôapp</li>
          </ul>
        </li>
        <li>üëâ L‚Äôutente <strong>non deve fare nulla manualmente</strong> per aggiornare.</li>
      </ul>

      <h2>Dati e cache</h2>
      <ul>
        <li>I dati possono essere salvati localmente (cache o storage).</li>
        <li>Cancellando i dati del browser o disinstallando la PWA, i dati locali vengono rimossi.</li>
      </ul>

      <hr>

      <h1>Regole di comportamento in chat pubblica</h1>

      <h2>Regole generali</h2>
      <ul>
        <li>Rispetto reciproco obbligatorio.</li>
        <li>Vietati insulti, linguaggio offensivo, discriminazioni o incitamento all‚Äôodio.</li>
        <li>Niente spam, flood o messaggi ripetuti.</li>
      </ul>

      <h2>Contenuti non consentiti</h2>
      <ul>
        <li>Violenza, minacce o molestie.</li>
        <li>Contenuti sessuali espliciti.</li>
        <li>Condivisione di dati personali propri o di terzi.</li>
        <li>Link dannosi o tentativi di truffa.</li>
      </ul>

      <h2>Buone pratiche</h2>
      <ul>
        <li>Usa un linguaggio chiaro e civile.</li>
        <li>Rimani in tema con la discussione.</li>
        <li>Segnala comportamenti scorretti ai moderatori.</li>
      </ul>

      <h2>Moderazione</h2>
      <ul>
        <li>I messaggi possono essere moderati.</li>
        <li>Violazioni ripetute possono portare a:
          <ul>
            <li>avvisi</li>
            <li>silenziamento temporaneo</li>
            <li>esclusione dalla chat</li>
          </ul>
        </li>
      </ul>

      <h2>Accettazione</h2>
      <p>L‚Äôuso della chat e dell‚Äôapp implica l‚Äôaccettazione di queste regole.</p>
    `;
  

  }

} // ‚Üê QUESTA CHIUDE open()
function artist(name, query){
  return `
    <div class="card">
      <strong style="display:block; margin-bottom:10px;">
        ${name}
      </strong>

      <div style="display:flex; gap:8px;">
        <button style="
          flex:1;
          padding:8px;
          border-radius:20px;
          border:2px solid #ff0033;
          background:#111;
          color:#ff0033;
          font-weight:bold;
          cursor:pointer;
        "
        onclick="openExternal('https://www.youtube.com/results?search_query=${query}')">
          üé• YouTube
        </button>

        <button style="
          flex:1;
          padding:8px;
          border-radius:20px;
          border:2px solid #00ff66;
          background:#111;
          color:#00ff66;
          font-weight:bold;
          cursor:pointer;
        "
        onclick="openExternal('https://open.spotify.com/search/${query}')">
          üéß Spotify
        </button>
      </div>
    </div>
  `;
}

function openPlaylist(type){

  if(type === "italian"){
    contentEl.innerHTML = `
      <h2>üáÆüáπ Artisti italiani anni ‚Äô80</h2>
      <div class="grid">
        ${artist("Pooh","pooh+anni+80")}
        ${artist("Vasco Rossi","vasco+rossi+anni+80")}
        ${artist("Claudio Baglioni","claudio+baglioni+anni+80")}
        ${artist("Umberto Tozzi","umberto+tozzi+anni+80")}
        ${artist("Eros Ramazzotti","eros+ramazzotti+anni+80")}
        ${artist("Lucio Dalla","lucio+dalla+anni+80")}
        ${artist("Renato Zero","renato+zero+anni+80")}
        ${artist("Gianna Nannini","gianna+nannini+anni+80")}
      </div>
    `;
  }

  if(type === "foreign"){
    contentEl.innerHTML = `
      <h2>‚≠ê Artisti stranieri anni ‚Äô80</h2>
      <div class="grid">
        ${artist("Michael Jackson","michael+jackson+80s")}
        ${artist("Madonna","madonna+80s")}
        ${artist("Prince","prince+80s")}
        ${artist("George Michael","george+michael+80s")}
        ${artist("Depeche Mode","depeche+mode+80s")}
        ${artist("Duran Duran","duran+duran+80s")}
        ${artist("A-ha","a+ha+80s")}
        ${artist("U2","u2+80s")}
      </div>
    `;
  }

}
 const gamesData = [

{
  name:"üïπÔ∏è Arcade",
  sub:[{
    name:"Portali Arcade",
    links:[
      {t:"Internet Arcade",u:"https://archive.org/details/internetarcade"},
      {t:"Arcade - RetroGames",u:"https://www.retrogames.cc/arcade-games.html"},
      {t:"Arcade - ClassicReload",u:"https://classicreload.com/arcade.html"}
    ]
  }]
},

{
  name:"üéÆ Nintendo NES",
  sub:[{
    name:"Console NES",
    links:[
      {t:"NES - RetroGames",u:"https://www.retrogames.cc/nes-games.html"},
      {t:"NES - ClassicReload",u:"https://classicreload.com/nes.html"},
      {t:"NES - Archive",u:"https://archive.org/details/softwarelibrary_nes"}
    ]
  }]
},

{
  name:"üïπÔ∏è Sega Master System",
  sub:[{
    name:"Sega 8-bit",
    links:[
      {t:"Sega Master - RetroGames",u:"https://www.retrogames.cc/sega-master-system-games.html"},
      {t:"Sega - ClassicReload",u:"https://classicreload.com/sega-master-system.html"},
      {t:"Sega - Archive",u:"https://archive.org/details/softwarelibrary_sms"}
    ]
  }]
},

{
  name:"üì∫ Atari 2600",
  sub:[{
    name:"Atari Classics",
    links:[
      {t:"Atari - RetroGames",u:"https://www.retrogames.cc/atari-2600-games.html"},
      {t:"Atari - ClassicReload",u:"https://classicreload.com/atari-2600.html"},
      {t:"Atari - Archive",u:"https://archive.org/details/softwarelibrary_atari_2600"}
    ]
  }]
},

{
  name:"üíæ Commodore 64",
  sub:[{
    name:"C64 Collection",
    links:[
      {t:"C64 - RetroGames",u:"https://www.retrogames.cc/c64-games.html"},
      {t:"C64 - ClassicReload",u:"https://classicreload.com/c64.html"},
      {t:"C64 - Archive",u:"https://archive.org/details/softwarelibrary_c64"}
    ]
  }]
},

{
  name:"üíø Amiga",
  sub:[{
    name:"Amiga Games",
    links:[
      {t:"Amiga - RetroGames",u:"https://www.retrogames.cc/amiga-games.html"},
      {t:"Amiga - ClassicReload",u:"https://classicreload.com/amiga.html"},
      {t:"Amiga - Archive",u:"https://archive.org/details/softwarelibrary_amiga"}
    ]
  }]
},

{
  name:"üñ•Ô∏è MS-DOS",
  sub:[{
    name:"DOS Games",
    links:[
      {t:"MS-DOS - Archive",u:"https://archive.org/details/softwarelibrary_msdos_games"},
      {t:"DOS - ClassicReload",u:"https://classicreload.com/msdos.html"},
      {t:"DOS - RetroGames",u:"https://www.retrogames.cc/dos-games.html"}
    ]
  }]
},

{
  name:"üß† ZX Spectrum",
  sub:[{
    name:"Spectrum Classics",
    links:[
      {t:"ZX - RetroGames",u:"https://www.retrogames.cc/zx-spectrum-games.html"},
      {t:"ZX - ClassicReload",u:"https://classicreload.com/zx-spectrum.html"},
      {t:"ZX - Archive",u:"https://archive.org/details/softwarelibrary_zx_spectrum"}
    ]
  }]
}

];

function loadGameFolders(){

  let html = `
    <h2>üéÆ Giochi anni '80</h2>
    <div class="grid">
  `;

  gamesData.forEach((folder,index)=>{
    html += `
      <div class="card" onclick="openSubFolder(${index})">
        <strong>${folder.name}</strong>
      </div>
    `;
  });

  html += `</div>`;

  contentEl.innerHTML = html;
}

function openSubFolder(index){
  const folder = gamesData[index];

  let html = `
    <button onclick="loadGameFolders()" 
      style="margin-bottom:12px;padding:6px 12px;border-radius:14px;border:2px solid #00e5ff;background:#111;color:#00e5ff;">
      ‚Üê Torna alle cartelle
    </button>

    <h2>${folder.name}</h2>
    <div class="grid">
  `;

  folder.sub.forEach(sub=>{
    html += `
      <div class="card">
        <strong style="display:block;margin-bottom:8px">
          ${sub.name}
        </strong>

        ${sub.links.map(link=>`
          <div style="margin:6px 0">
            <button style="
              width:100%;
              padding:8px;
              border-radius:20px;
              border:2px solid #00e5ff;
              background:#111;
              color:#00e5ff;
              font-weight:bold;
              cursor:pointer;
            "
            onclick="openExternal('${link.u}')">
              üïπÔ∏è ${link.t}
            </button>
          </div>
        `).join("")}
      </div>
    `;
  });

   html += `</div>`;
  contentEl.innerHTML = html;

} // ‚Üê QUESTA GRAFFA ERA MANCANTE

window.openSubFolder = openSubFolder;
window.openPlaylist = openPlaylist;

window.openExternal = function(url){

  const isStandalone = window.matchMedia('(display-mode: standalone)').matches 
                       || window.navigator.standalone;

  if (isStandalone) {
    // üî• Forza apertura fuori dalla PWA
    window.location.href = url;
  } else {
    window.open(url, "_blank");
  }
};





window.play=(u,n)=>{audio.src=u;audio.play();now.textContent="In riproduzione: "+n};
  setTimeout(()=>{
  document.getElementById("splash")?.remove();
},8000);
</script>

</body>
</html>
