<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Io negli anni â€™80 câ€™ero</title>

<style>
:root{
  --bg:#0f0f0f;
  --card:#1c1c1c;
  --accent:#00e5ff;
  --text:#ffffff;
  --muted:#aaaaaa;
}

*{
  box-sizing:border-box;
  margin:0;
  padding:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
}

body{
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  display:flex;
  flex-direction:column;
}

header{
  padding:20px;
  text-align:center;
  border-bottom:2px solid var(--accent);
}

header h1{
  color:var(--accent);
  font-size:2rem;
}

header p{
  color:var(--muted);
  margin-top:6px;
}

main{
  flex:1;
  padding:20px;
  padding-bottom:220px;
}

.categories{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
  gap:10px;
  margin-bottom:20px;
}

.category{
  border:2px solid var(--accent);
  padding:12px;
  text-align:center;
  border-radius:12px;
  cursor:pointer;
  font-weight:600;
}

.category.active,
.category:hover{
  background:var(--accent);
  color:#000;
}

#content{
  border:2px solid var(--accent);
  border-radius:14px;
  padding:16px;
  min-height:250px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:14px;
}

.card{
  background:var(--card);
  border:2px solid var(--accent);
  border-radius:14px;
  padding:14px;
  cursor:pointer;
  color:inherit;
  text-decoration:none;
}

.card:hover{
  background:var(--accent);
  color:#000;
}

.card .title{
  font-weight:700;
  margin-bottom:6px;
}

.card .desc{
  font-size:0.85rem;
  color:var(--muted);
}

/* PLAYER */
#player{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  background:var(--card);
  border-top:2px solid var(--accent);
  padding:10px;
  text-align:center;
  z-index:400;
}

#now{
  color:var(--accent);
  font-weight:700;
  margin-bottom:6px;
}

audio{
  width:90%;
}

/* CHAT */
#chat{
  position:fixed;
  bottom:calc(120px + env(safe-area-inset-bottom));
  left:50%;
  transform:translateX(-50%);
  width:600px;
  max-width:90%;
  height:260px;
  background:var(--card);
  border:2px solid var(--accent);
  border-radius:14px;
  display:flex;
  flex-direction:column;
  z-index:1000;
}

#chatHeader{
  height:40px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:0 10px;
  border-bottom:2px solid var(--accent);
}

#chatHeader button{
  background:none;
  border:none;
  color:var(--accent);
  font-size:18px;
  cursor:pointer;
}

#chatMessages{
  flex:1;
  overflow-y:auto;
  padding:8px;
  font-size:0.85rem;
}

#chatForm{
  display:flex;
  border-top:2px solid var(--accent);
  background:#1c1c1c;
}

#chatInput{
  flex:1;
  padding:6px;
  border:none;
  background:#222;
  color:#fff;
}

#chatForm button{
  padding:6px 12px;
  border:none;
  background:var(--accent);
  cursor:pointer;
}

/* CHAT MOBILE */
#chatToggle{
  position:fixed;
  bottom:120px;
  right:20px;
  width:52px;
  height:52px;
  border-radius:50%;
  background:var(--accent);
  border:none;
  font-size:22px;
  cursor:pointer;
  z-index:1001;
  display:none;
}

@media (max-width:900px){
  #chat{
    display:none;
    height:60%;
  }
  #chatToggle{
    display:block;
  }
}
</style>
</head>

<body>

<header>
  <h1>Io negli anni â€™80 câ€™ero</h1>
  <p>Musica, radio e chat in tempo reale</p>
</header>

<main>
  <div class="categories" id="categories"></div>
  <div id="content">Seleziona una categoria.</div>
</main>

<div id="player">
  <div id="now">Nessuna radio in riproduzione</div>
  <audio id="audio" controls playsinline></audio>
</div>

<button id="chatToggle">ðŸ’¬</button>

<div id="chat">
  <div id="chatHeader">
    <strong>Chat</strong>
    <button id="chatClose">âœ•</button>
  </div>
  <div id="chatMessages"></div>
  <form id="chatForm">
    <input id="chatInput" placeholder="Scrivi un messaggioâ€¦" autocomplete="off">
    <button type="submit">Invia</button>
  </form>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyB8h3fvyPxq_Tjp2R5RzsgEC7jv6FASeWE",
  authDomain: "anni-80-chat-a1192.firebaseapp.com",
  databaseURL: "https://anni-80-chat-a1192-default-rtdb.europe-west1.firebasedatabase.app/",
  projectId: "anni-80-chat-a1192",
  storageBucket: "anni-80-chat-a1192.firebasestorage.app",
  messagingSenderId: "578541128805",
  appId: "1:578541128805:web:854a987bf16439cb758a8c"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const chatRef = ref(db,"chat");

const chatForm = document.getElementById("chatForm");
const chatInput = document.getElementById("chatInput");
const chatMessages = document.getElementById("chatMessages");

chatForm.addEventListener("submit", e => {
  e.preventDefault();
  const text = chatInput.value.trim();
  if(text){
    push(chatRef,{text});
    chatInput.value="";
  }
});

onChildAdded(chatRef,snap=>{
  const div=document.createElement("div");
  div.textContent=snap.val().text;
  chatMessages.appendChild(div);
  chatMessages.scrollTop=chatMessages.scrollHeight;
});
</script>

<script>
/* CATEGORIE */
const categories=[
  {id:"musica",label:"Musica"},
  {id:"radio",label:"Radio"},
  {id:"giochi",label:"Giochi"},
  {id:"chat",label:"Chat"}
];

const radio=[
  {name:"Radio 80",url:"https://sphera.fluidstream.eu/radio80.aac",desc:"Pop e rock anni â€™80"},
  {name:"SomaFM Underground 80s",url:"https://ice2.somafm.com/u80s-128-aac",desc:"New wave anni â€™80"},
  {name:"80s80s Italo Disco",url:"https://regiocast.streamabc.net/regc-80s80sitalodisco-mp3-192-9093510",desc:"Italo disco"},
  {name:"Italia 80",url:"https://stream.laut.fm/italia80",desc:"Musica italiana"}
];

const musica=[
  {name:"Spotify Anni 80",url:"https://open.spotify.com/playlist/37i9dQZF1DX4UtSsGT1Sbe"},
  {name:"YouTube Hits 80",url:"https://www.youtube.com/results?search_query=hit+anni+80"}
];

const giochi=[
  {name:"Pac-Man",url:"https://www.retrogames.cz/play_001-NES.php"},
  {name:"Tetris",url:"https://tetris.com/play-tetris"}
];

const categoriesEl=document.getElementById("categories");
const contentEl=document.getElementById("content");
const audio=document.getElementById("audio");
const now=document.getElementById("now");

categories.forEach(c=>{
  const d=document.createElement("div");
  d.className="category";
  d.textContent=c.label;
  d.onclick=()=>openCategory(c.id,d);
  categoriesEl.appendChild(d);
});

function openCategory(id,el){
  document.querySelectorAll(".category").forEach(c=>c.classList.remove("active"));
  el.classList.add("active");

  if(id==="radio"){
    contentEl.innerHTML=`<div class="grid">${radio.map(r=>`
      <div class="card" onclick="playRadio('${r.url}','${r.name}')">
        <div class="title">${r.name}</div>
        <div class="desc">${r.desc}</div>
      </div>`).join("")}</div>`;
  }

  if(id==="musica"){
    contentEl.innerHTML=`<div class="grid">${musica.map(m=>`
      <a class="card" href="${m.url}" target="_blank">
        <div class="title">${m.name}</div>
        <div class="desc">Apri</div>
      </a>`).join("")}</div>`;
  }

  if(id==="giochi"){
    contentEl.innerHTML=`<div class="grid">${giochi.map(g=>`
      <a class="card" href="${g.url}" target="_blank">
        <div class="title">${g.name}</div>
        <div class="desc">Gioca</div>
      </a>`).join("")}</div>`;
  }

  if(id==="chat"){
    contentEl.innerHTML="<p>Usa la chat qui sotto ðŸ‘‡</p>";
  }
}

function playRadio(url,name){
  audio.src=url;
  audio.play();
  now.textContent="In riproduzione: "+name;
}

/* CHAT MOBILE */
const chat=document.getElementById("chat");
const toggle=document.getElementById("chatToggle");
const closeBtn=document.getElementById("chatClose");

toggle.onclick=()=>chat.style.display="flex";
closeBtn.onclick=()=>chat.style.display="none";

function layoutChat(){
  if(window.innerWidth>900){
    chat.style.display="flex";
    toggle.style.display="none";
  }else{
    chat.style.display="none";
    toggle.style.display="block";
  }
}
layoutChat();
window.addEventListener("resize",layoutChat);
</script>

</body>
</html>
