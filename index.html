<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Io negli anni ‚Äô80 c‚Äôero</title>

<link rel="manifest" href="/anni80-pwa/manifest.json">
<meta name="theme-color" content="#00e5ff">

<link rel="icon" href="/anni80-pwa/favicon.ico">
<link rel="icon" type="image/png" sizes="192x192" href="/anni80-pwa/icon-192.png">

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial,Helvetica,sans-serif}
body{background:#0f0f0f;color:#fff;min-height:100vh;display:flex;flex-direction:column}

header{text-align:center;padding:16px;border-bottom:2px solid #00e5ff}
header h1{color:#00e5ff}
header p{color:#aaa;font-size:.9rem}

main{flex:1;padding:12px;padding-bottom:190px}

.categories{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:12px}
.category{border:2px solid #00e5ff;border-radius:14px;padding:12px;text-align:center;font-weight:bold;cursor:pointer}
.category.active{background:#00e5ff;color:#000}

#content,#chat-info{
  border:2px solid #00e5ff;
  border-radius:14px;
  padding:14px;
  min-height:200px;
}

.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.card{border:2px solid #00e5ff;border-radius:14px;padding:14px;background:#1c1c1c;text-align:center}
.card:hover{background:#00e5ff;color:#000}
a.card{text-decoration:none;color:inherit}

#chat-info{display:none}

#player{
  position:fixed;bottom:0;left:0;width:100%;
  background:#1c1c1c;border-top:2px solid #00e5ff;
  padding:10px;text-align:center;z-index:500
}

#chat{
  position:fixed;inset:0;background:#111;
  display:none;flex-direction:column;z-index:2000
}

#chatHeader{
  padding:14px;background:#161616;
  border-bottom:1px solid #222;
  display:flex;justify-content:space-between
}

#chatHeader strong{color:#00e5ff}
#chatMessages{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:10px}

.message{background:#1f1f1f;border-radius:14px;padding:10px 12px;max-width:85%}
.message strong{color:#00e5ff;font-size:.85rem;display:block}

#chatForm{display:flex;padding:10px;gap:8px;background:#161616}
#chatInput{
  flex:1;padding:12px 14px;border-radius:20px;
  border:none;background:#2a2a2a;color:#fff;font-size:16px
}

#chatForm button{
  padding:12px 18px;border-radius:20px;
  border:none;background:#00e5ff;font-weight:bold
}

#chatToggle{
  position:fixed;bottom:200px;right:14px;
  width:56px;height:56px;border-radius:50%;
  background:#00e5ff;border:none;font-size:26px;z-index:1100
}
</style>
</head>

<body>

<header>
  <h1>Io negli anni ‚Äô80 c‚Äôero</h1>
  <p>Musica ¬∑ Radio ¬∑ Giochi ¬∑ Chat-Info</p>
</header>

<main>
  <div class="categories" id="categories"></div>

  <div id="content">Seleziona una sezione.</div>

  <div id="chat-info">
    <h2>Chat ‚Äì Informazioni</h2>

    <p><strong>Installazione app</strong></p>
    <ul>
      <li><b>Android:</b> Aggiungi alla schermata Home</li>
      <li><b>iPhone / iPad:</b> Condividi ‚Üí Aggiungi a Home</li>
      <li><b>PC / Mac:</b> Installa dal browser</li>
    </ul>

    <p><strong>Aggiornamenti</strong></p>
    <p>L‚Äôapp si aggiorna automaticamente.</p>

    <p><strong>Regole chat</strong></p>
    <ul>
      <li>Rispetto reciproco</li>
      <li>Niente spam</li>
      <li>Niente contenuti offensivi</li>
    </ul>

    <button onclick="entraInChat()">Entra in chat</button>
  </div>
</main>

<button id="chatToggle">üí¨</button>

<div id="chat">
  <div id="chatHeader">
    <strong>üí¨ Chat anni ‚Äô80</strong>
    <button onclick="closeChat()" style="background:none;border:none;color:#00e5ff;font-size:22px">‚úï</button>
  </div>
  <div id="chatMessages"></div>
  <form id="chatForm">
    <input id="chatInput" placeholder="Scrivi un messaggio‚Ä¶">
    <button>Invia</button>
  </form>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

const app=initializeApp({
  apiKey:"AIzaSyB8h3fvyPxq_Tjp2R5RzsgEC7jv6FASeWE",
  databaseURL:"https://anni-80-chat-a1192-default-rtdb.europe-west1.firebasedatabase.app"
});
const db=getDatabase(app);
const chatRef=ref(db,"chat");

const chat=document.getElementById("chat");
const chatMessages=document.getElementById("chatMessages");
const chatInput=document.getElementById("chatInput");

document.getElementById("chatForm").onsubmit=e=>{
  e.preventDefault();
  if(chatInput.value.trim()){
    push(chatRef,{nick:"Anonimo",text:chatInput.value});
    chatInput.value="";
  }
};

onChildAdded(chatRef,s=>{
  const m=s.val();
  const d=document.createElement("div");
  d.className="message";
  d.innerHTML=`<strong>${m.nick}</strong>${m.text}`;
  chatMessages.appendChild(d);
  chatMessages.scrollTop=chatMessages.scrollHeight;
});

window.closeChat=()=>chat.style.display="none";
window.entraInChat=()=>{
  document.getElementById("chat-info").style.display="none";
  chat.style.display="flex";
};

document.getElementById("chatToggle").onclick=()=>chat.style.display="flex";

const categories=["Musica","Radio","Giochi","Chat-Info"];
const categoriesEl=document.getElementById("categories");
const content=document.getElementById("content");
const chatInfo=document.getElementById("chat-info");

categories.forEach((c,i)=>{
  const d=document.createElement("div");
  d.className="category";
  d.textContent=c;
  d.onclick=()=>{
    document.querySelectorAll(".category").forEach(x=>x.classList.remove("active"));
    d.classList.add("active");
    chatInfo.style.display="none";
    content.style.display="block";

    if(i===0)content.innerHTML="üéµ Musica anni 80";
    if(i===1)content.innerHTML="üìª Radio anni 80";
    if(i===2)content.innerHTML="üïπÔ∏è Giochi retr√≤";
    if(i===3){
      content.style.display="none";
      chatInfo.style.display="block";
    }
  };
  categoriesEl.appendChild(d);
});
</script>

</body>
</html>
